# Feature 0003: Dynamic Time Availability Elements

## Description
Implement dynamic time availability elements that appear when days are selected in the availability page. Each selected day will display a time range selector with a sliding timeline interface, allowing users to set their available hours for that specific day. The timeline will show hourly ticks with major labels every 2 hours, and display the selected start/end times in dedicated boxes.

## Technical Requirements

### Configuration System
- **File**: `config/availability-config.js`
- **Purpose**: Centralized configuration for time ranges and validation rules
- **Structure**:
  - Day-specific time ranges (start/end hours)
  - Minimum working hours requirement
  - Timeline display settings

### Dynamic UI Components

#### 1. Time Availability Container
- **Trigger**: Appears when a day checkbox is selected
- **Structure**: Rectangle container similar to "Days Available" section
- **Title**: Dynamic day name (e.g., "Wednesday")
- **Content**: Timeline slider + time display boxes

#### 2. Timeline Slider
- **Range**: 9:00 AM to 10:00 PM (default), 9:00 AM to 4:00 PM (Sundays)
- **Granularity**: Hourly ticks with selectable positions
- **Labels**: Major axis labels every 2 hours (9:00 AM, 11:00 AM, 1:00 PM, etc.)
- **Handles**: Two draggable circular handles for start/end time selection
- **Visual**: Horizontal timeline with highlighted selected range

#### 3. Time Display Boxes
- **Start Time Box**: Shows selected start time (e.g., [10:00])
- **End Time Box**: Shows selected end time (e.g., [16:00])
- **Position**: Below or beside the timeline
- **Format**: 24-hour format with hour:minute display

### Validation Rules
- **Minimum Hours**: Configurable minimum working hours (default: 4 hours)
- **Time Range**: Must respect day-specific start/end boundaries
- **Logic**: End time must be at least `min_working_hours` after start time

## Files to Create/Modify

### 1. config/availability-config.js (NEW)
```javascript
const AVAILABILITY_CONFIG = {
  minWorkingHours: 4,
  dayTimeRanges: {
    tuesday: { start: 9, end: 22 },
    wednesday: { start: 9, end: 22 },
    thursday: { start: 9, end: 22 },
    friday: { start: 9, end: 22 },
    saturday: { start: 9, end: 22 },
    sunday: { start: 9, end: 16 }
  },
  timelineSettings: {
    majorTickInterval: 2, // hours
    minorTickInterval: 1, // hours
    handleSize: 20,
    trackHeight: 8
  }
};
```

### 2. availability.html (MODIFY)
- Add container for dynamic time availability elements
- Include script reference to availability-config.js
- Add CSS classes for timeline components

### 3. script.js (MODIFY)
- Add `createTimeAvailabilityElement(day)` function
- Add `setupTimelineSlider(day, container)` function
- Add `handleTimelineInteraction()` function
- Add `validateTimeRange(startTime, endTime, day)` function
- Add `updateTimeDisplay(startTime, endTime, container)` function
- Modify `handleDaySelection()` to create/remove time elements
- Add timeline drag and drop functionality

### 4. styles.css (MODIFY)
- Add `.time-availability-container` class
- Add `.timeline-slider` class and sub-components
- Add `.timeline-track` class for the horizontal line
- Add `.timeline-handle` class for draggable circles
- Add `.timeline-tick` classes for major/minor ticks
- Add `.time-display-box` class for start/end time boxes
- Add `.timeline-range` class for highlighted selected range
- Add responsive styles for mobile timeline interaction

## Algorithm for Timeline Functionality

### 1. Dynamic Element Creation
1. When day checkbox is checked, call `createTimeAvailabilityElement(day)`
2. Create container div with day-specific title
3. Generate timeline HTML structure with ticks and handles
4. Add time display boxes
5. Append to availability page container
6. Initialize timeline interaction handlers

### 2. Timeline Rendering
1. Calculate total timeline width based on day's time range
2. Generate hourly tick marks (minor ticks)
3. Generate 2-hour interval labels (major ticks)
4. Position start handle at beginning of range
5. Position end handle at `min_working_hours` from start
6. Render highlighted range between handles

### 3. Handle Interaction
1. Detect mouse/touch down on timeline handle
2. Calculate handle position based on mouse/touch coordinates
3. Snap to nearest hour tick
4. Validate minimum working hours constraint
5. Update other handle position if constraint violated
6. Update time display boxes
7. Redraw highlighted range

### 4. Time Validation
1. Check if end time is at least `min_working_hours` after start time
2. Ensure both times are within day's allowed range
3. Prevent handles from crossing each other
4. Show visual feedback for invalid selections

## Data Structure for Time Selections

```javascript
let timeSelections = {
  tuesday: { start: null, end: null },
  wednesday: { start: null, end: null },
  thursday: { start: null, end: null },
  friday: { start: null, end: null },
  saturday: { start: null, end: null },
  sunday: { start: null, end: null }
};
```

## Implementation Phases

### Phase 1: Configuration and Basic Structure
1. Create `config/availability-config.js` with time ranges and settings
2. Add basic HTML structure for time availability containers
3. Implement `createTimeAvailabilityElement()` function
4. Add basic CSS styling for containers and timeline

### Phase 2: Timeline Rendering
1. Implement timeline tick generation and positioning
2. Add timeline track and handle rendering
3. Create time display box components
4. Add responsive styling for different screen sizes

### Phase 3: Interaction and Validation
1. Implement handle drag functionality
2. Add time validation logic
3. Create visual feedback for invalid selections
4. Implement minimum working hours constraint
5. Add touch support for mobile devices

### Phase 4: Integration and Polish
1. Integrate with existing day selection logic
2. Add smooth animations and transitions
3. Implement data persistence for time selections
4. Add accessibility features (keyboard navigation)
5. Test across different devices and browsers

## Technical Considerations

### Mobile Optimization
- Touch-friendly handle sizes (minimum 44px touch target)
- Smooth touch scrolling and dragging
- Responsive timeline width and tick spacing
- Optimized rendering for performance

### Accessibility
- Keyboard navigation for timeline handles
- Screen reader support for time selections
- High contrast mode compatibility
- Focus indicators for interactive elements

### Performance
- Efficient DOM updates during dragging
- Debounced validation checks
- Minimal re-rendering of timeline elements
- Optimized event handling for smooth interaction
